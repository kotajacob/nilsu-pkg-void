# Template file for 'hare'
pkgname=hare
version=0.0.20220927
revision=1
_gitrev=82213191adc25137c704df4786a71bce40b6079f
wrksrc="${pkgname}-${_gitrev}"
build_style=gnu-makefile
hostmakedepends="scdoc"
makedepends="qbe harec"
depends="qbe harec"
short_desc="The Hare systems programming language"
maintainer="Dakota Walsh <kota@nilsu.org>"
license="MPL-2.0 AND GPL-3.0-only"
homepage="https://harelang.org/"
distfiles="https://git.sr.ht/~sircmpwn/hare/archive/${_gitrev}.tar.gz"
checksum=6a1dbbcce7812c8a19f9e6b7da4ef668525dfc141b1350f3b3cb4d1b2ff1b677

do_build() {
	cp ${FILESDIR}/config.mk config.mk
	export VERSION="dev+$(echo "${_gitrev}" | cut -c-7)"
	export LOCALVER=void
	make -j1 # XXX: parallel build driver builds are broken
}

do_install() {
	make DESTDIR=${DESTDIR} install
}
